<div class="flex gap-5">
  <div class="flex flex-column gap-5">
    <div class="steps">
      <p-card>
        <p-steps [activeIndex]="checkoutFormService.step()" [model]="steps"/>
      </p-card>
    </div>

    <div class="small-steps">
      <p-card>
        <app-small-screen-steps [activeIndex]="checkoutFormService.step()" [items]="steps"/>
      </p-card>
    </div>

    <div class="form-container flex flex-column gap-6 align-items-center">
      <form class="form w-full" [formGroup]="form" (ngSubmit)="onSubmit()">

        <!-- STEP ONE -->
        @if (checkoutFormService.step() === 0) {
          <app-checkout-step-one-who/>
        }

        <!-- STEP TWO -->
        @if (checkoutFormService.step() === 1) {
          <app-checkout-step-two-where/>
        }

        <!-- STEP THREE -->
        @if (checkoutFormService.step() === 2) {
          <div formGroupName="when" class="flex flex-column">
            <label for="deliveryChoice">Hora de entrega*</label>
            <select id="deliveryChoice" formControlName="deliveryTime"
                    (change)="checkoutFormService.toggleProgrammedDeliveryTime($event.target)">
              <option value="Lo antes posible">Lo antes posible</option>
              <option value="Hora programada">Hora programada</option>
            </select>

            @if (checkoutFormService.programmedDelivery()) {
              <label for="deliveryTime">Selecciona la hora de entrega*</label>
              <select id="deliveryTime" formControlName="deliveryTime">
                <option value="15:00">15:00</option>
                <option value="13:00">13:00</option>
              </select>
            }
          </div>
        }

        <!-- STEP FOUR -->
        @if (checkoutFormService.step() === 3) {
          <div formGroupName="how" class="flex flex-column">
            <label for="paymentMethod">Método de pago*</label>
            <select id="paymentMethod" formControlName="paymentMethod"
                    (change)="checkoutFormService.toggleRequestChangeOption(form.controls.how.controls.changeRequestChoice, $event.target)">
              <option value="Tarjeta">Tarjeta</option>
              <option value="Efectivo">Efectivo</option>
            </select>

            <label for="changeRequestChoice">¿Necesita cambio?*</label>
            <select id="changeRequestChoice" formControlName="changeRequestChoice"
                    (change)="checkoutFormService.toggleChangeRequestInput($event.target)">
              <option value="V">Sí</option>
              <option value="F">No</option>
            </select>

            @if (checkoutFormService.changeRequested()) {
              <label for="billToChange">Cambio de*</label>
              <input id="billToChange" type="number" formControlName="billToChange">
            }

            <label for="comment">Observaciones</label>
            <textarea id="comment" formControlName="comment"></textarea>
          </div>
        }

        <!-- STEP FIVE -->
        @if (checkoutFormService.step() === 4) {

        }

        <!-- SUBMIT - STEP 5 ONLY -->

      </form>
    </div>

  </div>
  <div class="sm-cart">
    <app-cart-checkout/>
  </div>
</div>
